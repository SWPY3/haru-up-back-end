# PostgreSQL 17.6 Configuration
# 메모리/버퍼
shared_buffers = 4GB                 # 컨테이너 메모리의 ~25%
work_mem = 64MB                      # 리포트 role 분리 권장
maintenance_work_mem = 1GB

# 체크포인트/WAL
checkpoint_timeout = 20min
max_wal_size = 16GB
wal_compression = on

# 병렬/IO
effective_cache_size = 12GB          # 컨테이너 메모리 여유에 맞게
effective_io_concurrency = 200
max_worker_processes = 8
max_parallel_workers = 8
max_parallel_workers_per_gather = 2

# Autovacuum
autovacuum = on
autovacuum_naptime = 15s
autovacuum_vacuum_cost_limit = 3000

# 로깅/관측
shared_preload_libraries = 'pg_stat_statements'
pg_stat_statements.max = 10000
pg_stat_statements.track = all
log_min_duration_statement = 1000    # 1s 이상 쿼리 로깅(초기)

# 연결 설정
listen_addresses = '*'
port = 5432
max_connections = 200

# 기본 데이터베이스 설정
timezone = 'Asia/Seoul'
datestyle = 'iso, mdy'
default_text_search_config = 'pg_catalog.english'